(()=>{var t={991:(t,e,r)=>{"use strict";r.d(e,{$q:()=>i,CT:()=>l,Qi:()=>c,Xx:()=>s,ZA:()=>a,jl:()=>u,kl:()=>f,yY:()=>o});var n=r(147).version,o="temp",i="en",a=!0,c="//dkny.oss-cn-hangzhou.aliyuncs.com/2",s="https://cdn.jsdelivr.net/gh/im6/vp@v".concat(n,"/dist/public"),u="canvas",l="lang",f="_REDUXSTATE_"},598:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var n=r(184);const o=(0,n.createReducer)({list:null,loading:!1},(function(t){t.addCase((0,n.createAction)("admin/getList"),(function(t){t.loading=!0})).addCase((0,n.createAction)("admin/getList/success"),(function(t,e){t.loading=!1,t.list=e.payload})).addCase((0,n.createAction)("admin/getList/fail"),(function(t){t.loading=!1,t.list=[]})).addCase((0,n.createAction)("admin/decideColor"),(function(t,e){t.list=t.list.filter((function(t){return t.id!==e.payload.id}))}))}))},616:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var n=r(184);const o=(0,n.createReducer)({loading:!1,colorDef:{},liked:{},colorIdAllByDate:[],colorIdAllByStar:[],colorIdByMyOwn:[]},(function(t){t.addCase((0,n.createAction)("color/get"),(function(t){t.loading=!0})).addCase((0,n.createAction)("color/get/success"),(function(t,e){var r=e.payload,n=[],o={};r.forEach((function(t){n.push(t.id),o[t.id]=t}));var i=r.sort((function(t,e){return e.star-t.star})).map((function(t){return t.id}));t.loading=!1,t.colorDef=o,t.colorIdAllByDate=n,t.colorIdAllByStar=i})).addCase((0,n.createAction)("color/get/fail"),(function(t){t.loading=!1,t.colorIdAllByDate=[],t.colorIdAllByStar=[]})).addCase((0,n.createAction)("color/toggleLike"),(function(t,e){var r=e.payload,n=r.willLike,o=r.id;n?t.liked[o]=!0:delete t.liked[o],t.colorDef[o].star+=n?1:-1})).addCase((0,n.createAction)("color/addNew/success"),(function(t,e){var r=e.payload,n=r.id;t.colorDef[n]=r,t.colorIdAllByDate.unshift(n),t.colorIdAllByStar.push(n)})).addCase((0,n.createAction)("color/set/likes"),(function(t,e){var r=e.payload.reduce((function(t,e){return t[e]=!0,t}),{});t.liked=r})).addCase((0,n.createAction)("color/set/owns"),(function(t,e){t.colorIdByMyOwn=e.payload}))}))},141:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>i});var n=r(184),o={type:null,message:null,visible:!1};const i=(0,n.createReducer)(o,(function(t){t.addCase((0,n.createAction)("modal/reset"),(function(){return o})).addCase((0,n.createAction)("modal/set"),(function(t,e){return{type:e.payload[0],message:e.payload[1],visible:!1}})).addCase((0,n.createAction)("modal/show"),(function(t){t.visible=!0})).addCase((0,n.createAction)("modal/hide"),(function(t){t.visible=!1}))}))},137:(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});var n=r(184);const o=(0,n.createReducer)({detail:null,weiboUrl:null,githubUrl:null,facebookUrl:null,loading:!1},(function(t){t.addCase((0,n.createAction)("user/auth"),(function(t){t.loading=!0})).addCase((0,n.createAction)("user/auth/success"),(function(t,e){t.loading=!1,t.detail=e.payload})).addCase((0,n.createAction)("user/auth/fail"),(function(t){t.loading=!1,t.detail=null})).addCase((0,n.createAction)("user/logoff"),(function(t){t.detail=null})).addCase((0,n.createAction)("user/logoff/success"),(function(t,e){var r=e.payload,n=r.weiboUrl,o=r.githubUrl,i=r.facebookUrl;t.detail=null,t.weiboUrl=n,t.githubUrl=o,t.facebookUrl=i}))}))},470:(t,e,r)=>{"use strict";r.d(e,{Bu:()=>g,Fj:()=>h,Fq:()=>p,G:()=>s,G4:()=>f,GT:()=>v,Mh:()=>c,Ov:()=>b,QA:()=>y,TM:()=>j,X:()=>l,ZK:()=>m,_7:()=>w,_h:()=>d,bJ:()=>a,e8:()=>x,px:()=>i,xZ:()=>u});var n=r(991);var o=process.env,i=o.PORT,a=o.SESSION_SECRET,c=o.CSRF_EXCEPTION,s=o.FB_API_URL,u=o.FB_APP_KEY,l=o.FB_APP_SECRET,f=o.FB_REDIRECT_URL,p=o.WB_API_URL,d=o.WB_APP_KEY,h=o.WB_APP_SECRET,v=o.WB_REDIRECT_URL,m=o.GH_API_URL,y=o.GH_APP_KEY,g=o.GH_APP_SECRET,b=o.GH_REDIRECT_URL,w=n.Xx,x="./".concat("dist","/server"),j=["/robots.txt","/sitemap.xml","/favicon.ico"];c||console.log("No CSRF exception defined"),i||(console.error("No port defined."),process.exit(1))},619:(t,e,r)=>{"use strict";r.d(e,{Z:()=>c});var n=r(17),o=r.n(n),i=r(470),a=i.TM.reduce((function(t,e){return t[e]=!0,t}),{});const c=function(t,e,r){var n=t.url;if(Object.prototype.hasOwnProperty.call(a,n)){var c=o().resolve(process.cwd(),"".concat(i.e8).concat(n));e.sendFile(c)}else r(404)}},287:(t,e,r)=>{var n={"./admin.js":598,"./color.js":616,"./modal.js":141,"./user.js":137};function o(t){var e=i(t);return r(e)}function i(t){if(!r.o(n,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return n[t]}o.keys=function(){return Object.keys(n)},o.resolve=i,t.exports=o,o.id=287},184:t=>{"use strict";t.exports=require("@reduxjs/toolkit")},17:t=>{"use strict";t.exports=require("path")},147:t=>{"use strict";t.exports=JSON.parse('{"name":"vp","version":"1.29.0","description":"source code of react.colorpk.com","engines":{"node":">= 16.x"},"scripts":{"dev":"webpack --config ./webpack/develop.js","lint":"eslint ./webpack ./src","test":"jest --coverage","t":"yarn lint && yarn test","build":"webpack --config ./webpack/production.js","start":"node dist/server"},"repository":"git+https://github.com/im6/vp.git","author":"im6","license":"ISC","bugs":{"url":"https://github.com/im6/vp/issues"},"homepage":"https://github.com/im6/vp#readme","devDependencies":{"@babel/core":"^7.22.1","@babel/preset-env":"7.22.4","@babel/preset-react":"^7.22.3","@testing-library/react":"^14.0.0","autoprefixer":"^10.4.14","babel-loader":"^9.1.2","bulma":"^0.9.4","clean-webpack-plugin":"^4.0.0","compression-webpack-plugin":"^10.0.0","copy-webpack-plugin":"^11.0.0","css-loader":"^6.8.1","css-minimizer-webpack-plugin":"^5.0.0","dotenv":"^16.1.4","eslint":"^8.42.0","eslint-config-airbnb":"^19.0.4","eslint-config-prettier":"^8.8.0","eslint-plugin-import":"^2.27.5","eslint-plugin-jest":"^27.2.1","eslint-plugin-jsx-a11y":"^6.7.1","eslint-plugin-prettier":"^4.2.1","eslint-plugin-react":"7.32.2","eslint-plugin-react-hooks":"^4.6.0","jest":"^29.5.0","jest-environment-jsdom":"^29.5.0","js-cookie":"^3.0.5","mini-css-extract-plugin":"^2.7.6","node-sass":"^9.0.0","postcss":"^8.4.24","postcss-loader":"^7.3.2","prettier":"^2.8.8","react-color":"^2.19.3","redux-logger":"^3.0.6","redux-observable":"^2.0.0","rxjs":"^7.8.1","sass-loader":"^13.3.1","webpack":"^5.85.1","webpack-cli":"^5.1.3","webpack-node-externals":"^3.0.0"},"dependencies":{"@reduxjs/toolkit":"^1.9.5","axios":"^1.4.0","body-parser":"^1.20.2","connect-redis":"^7.1.0","cookie-parser":"^1.4.6","csurf":"^1.11.0","express":"^4.18.2","express-graphql":"^0.12.0","express-session":"^1.17.3","graphql":"^15.7.2","helmet":"^7.0.0","lodash.get":"^4.4.2","mongodb":"^5.6.0","prop-types":"^15.8.1","react":"^18.2.0","react-dom":"^18.2.0","react-redux":"^8.0.7","react-router-dom":"^6.12.0","redis":"^4.6.7","serialize-javascript":"^6.0.1","uuid":"^9.0.0"},"prettier":{"endOfLine":"auto","trailingComma":"es5","tabWidth":2,"semi":true,"singleQuote":true},"babel":{"presets":["@babel/preset-env",["@babel/preset-react",{"runtime":"automatic"}]]},"eslintConfig":{"extends":["airbnb","prettier","plugin:react-hooks/recommended"],"plugins":["react","jsx-a11y","import","prettier","jest"],"rules":{"prettier/prettier":2,"import/no-extraneous-dependencies":0,"react-hooks/rules-of-hooks":"error","react-hooks/exhaustive-deps":"warn","import/no-unresolved":[2,{"ignore":["^components/"]}],"no-param-reassign":["error",{"props":true,"ignorePropertyModificationsFor":["acc","req","res","draft"]}]},"env":{"browser":true,"jest/globals":true}},"jest":{"verbose":false,"testEnvironment":"jsdom","clearMocks":true,"moduleDirectories":["node_modules","<rootDir>/src/testing"],"moduleNameMapper":{"\\\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$":"<rootDir>/src/testing/fileMock.js","\\\\.(css|sass)$":"<rootDir>/src/testing/styleMock.js","^components/(.*)":"<rootDir>/src/components/$1"},"coverageDirectory":"coverage","coverageThreshold":{"global":{"branches":100,"functions":100,"lines":100,"statements":-10}}},"browserslist":["defaults","cover 99.5%"]}')}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";const t=require("child_process"),e=require("helmet");var n=r.n(e);const o=require("express");var i=r.n(o);const a=require("body-parser"),c=require("cookie-parser");var s=r.n(c);const u=require("redis"),l=require("express-session");var f=r.n(l);const p=require("connect-redis");var d=r.n(p),h=r(470),v=process.env,m=v.REDIS_HOST,y=v.REDIS_PORT,g=v.REDIS_PASSWORD;m&&y&&g||(console.error("missing redis connection info"),process.exit(1));var b=(0,u.createClient)({url:"redis://:".concat(g,"@").concat(m,":").concat(y)});b.on("error",(function(t){console.error(t),process.exit(1)})),b.on("reconnecting",(function(t,e){console.log("reconnecting, attempt: ".concat(e))})),b.on("connect",(function(){console.log("Redis connect successfully.")})),b.connect();const w=f()({store:new(d())({client:b}),secret:h.bJ,resave:!1,saveUninitialized:!1}),x=require("mongodb");function j(t){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},j(t)}function k(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */k=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function u(t,e,r,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new E(o||[]);return n(a,"_invoke",{value:x(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f={};function p(){}function d(){}function h(){}var v={};s(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(S([])));y&&y!==e&&r.call(y,i)&&(v=y);var g=h.prototype=p.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,a,c){var s=l(t[n],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==j(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return o("throw",t,a,c)}))}c(s.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function x(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return C()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=L(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function L(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,L(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function S(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:C}}function C(){return{value:void 0,done:!0}}return d.prototype=h,n(g,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:d,configurable:!0}),d.displayName=s(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=S,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function L(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}var O=process.env,_=O.MONGO_CONN,E=O.MONGO_CRED_PATH;if(!_||!E)throw console.log("MONGO_CONN",_),console.log("credentials",E),new Error("MongoDB connection info is missing.");var S=new x.MongoClient(_,{sslKey:E,sslCert:E,serverApi:x.ServerApiVersion.v1}),C=function(){var t,e=(t=k().mark((function t(){return k().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,S.connect();case 3:console.log("Connected to MongoDB successfully."),t.next=11;break;case 6:t.prev=6,t.t0=t.catch(0),console.error("MongoDB connection error!",t.t0),S.close(),process.exit(1);case 11:case"end":return t.stop()}}),t,null,[[0,6]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){L(i,n,o,a,c,"next",t)}function c(t){L(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(){return e.apply(this,arguments)}}(),I=S;const A=require("lodash.get");var N=r.n(A);const P=require("uuid"),T=require("axios");var R=r.n(T),D=function(t,e){if("fb"===t)return"https://www.facebook.com/v3.3/dialog/oauth?client_id=".concat(h.xZ,"&response_type=code&state=").concat(e,"&redirect_uri=").concat(h.G4);if("wb"===t)return"https://api.weibo.com/oauth2/authorize?client_id=".concat(h._h,"&scope=follow_app_official_microblog&state=").concat(e,"&redirect_uri=").concat(h.GT);if("gh"===t)return"https://github.com/login/oauth/authorize?client_id=".concat(h.QA,"&state=").concat(e,"&redirect_uri=").concat(h.Ov);throw new Error},G=function(t){var e={client_id:h.xZ,client_secret:h.X,code:t,redirect_uri:h.G4};return R()({baseURL:h.G,method:"get",url:"/oauth/access_token",params:e}).then((function(t){var e=t.data;return{access_token:e.access_token,expires_in:e.expires_in}}))},q=function(t){var e={client_id:h._h,client_secret:h.Fj,code:t,redirect_uri:h.GT,grant_type:"authorization_code"};return R()({baseURL:h.Fq,method:"post",url:"/oauth2/access_token",params:e}).then((function(t){var e=t.data,r=e.access_token,n=e.expires_in;return{uid:e.uid,access_token:r,expires_in:n}}))},M=function(t){var e={client_id:h.QA,client_secret:h.Bu,code:t,redirect_uri:h.Ov};return R()({method:"post",url:"https://github.com/login/oauth/access_token",headers:{Accept:"application/json"},params:e}).then((function(t){return{access_token:t.data.access_token}}))},U=function(t){var e=t.uid,r=t.access_token;return R()({baseURL:h.Fq,method:"get",url:"/2/users/show.json",params:{uid:e,access_token:r}}).then((function(t){var e=t.data;return{oauthId:e.id,name:e.name,img:e.profile_image_url}}))},B=function(t){var e=t.access_token;return R()({baseURL:h.ZK,method:"get",url:"/user",headers:{Authorization:"token ".concat(e)}}).then((function(t){var e=t.data;return{oauthId:e.id,name:e.name||e.login,img:e.avatar_url}}))},F=function(t,e){return Boolean(N()(t,"session.app.isAuth",!1)&&(e||N()(t,"session.app.dbInfo.id",null)))},Y=function(t){return N()(t,"session.app.tokenInfo",null)},H=function(t){return F(t)&&N()(t,"session.app.dbInfo.isAdmin",!1)};function Q(t){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Q(t)}function z(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */z=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function u(t,e,r,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new O(o||[]);return n(a,"_invoke",{value:x(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f={};function p(){}function d(){}function h(){}var v={};s(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,i)&&(v=y);var g=h.prototype=p.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,a,c){var s=l(t[n],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==Q(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return o("throw",t,a,c)}))}c(s.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function x(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=j(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function j(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,j(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function _(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return d.prototype=h,n(g,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:d,configurable:!0}),d.displayName=s(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function $(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}var V=function(){var t,e=(t=z().mark((function t(e,r){var n,o,i,a,c;return z().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=N()(e,"query.code",null),o=N()(e,"query.state",null),i=N()(e,"params.oauth",null),a=N()(e,"session.app.oauthState",null),!n||!o||o!==a){t.next=29;break}if(console.log("redirected by ".concat(i," auth...")),c=null,"fb"!==i){t.next=13;break}return t.next=10,G(n);case 10:c=t.sent,t.next=26;break;case 13:if("wb"!==i){t.next=19;break}return t.next=16,q(n);case 16:c=t.sent,t.next=26;break;case 19:if("gh"!==i){t.next=25;break}return t.next=22,M(n);case 22:c=t.sent,t.next=26;break;case 25:throw new Error;case 26:e.session.app=c?{oauth:i,isAuth:!0,tokenInfo:c}:{isAuth:!1,authError:"get token failed."},t.next=31;break;case 29:console.log("inconsistant session, error msg in session"),e.session.app={isAuth:!1,authError:"Sorry, something error, please try again."};case 31:r.redirect("/");case 32:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){$(i,n,o,a,c,"next",t)}function c(t){$(i,n,o,a,c,"throw",t)}a(void 0)}))});return function(t,r){return e.apply(this,arguments)}}(),K=r(17),X=r.n(K)().resolve(process.cwd(),"".concat(h.e8,"/error.html"));const Z=require("csurf");var W=r.n(Z)()();const J=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];N()(e[0],"body._csrf",null)===h.Mh?(console.log("csrf exception"),e[2]()):W.apply(undefined,e)},tt=require("express-graphql"),et=require("graphql");var rt=function(t){return function(t){return/^(#[a-f0-9]{6}){4}$/.test(t)}(t)&&function(t){var e={cnt:0},r=[t.substring(0,7),t.substring(7,14),t.substring(14,21),t.substring(21)];return r.forEach((function(t){Object.prototype.hasOwnProperty.call(e,t)||(e[t]=!0,e.cnt+=1)})),e.cnt===r.length}(t)};function nt(t){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(t)}function ot(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function it(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(r),!0).forEach((function(e){at(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ot(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function at(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==nt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==nt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"===nt(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ct(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ct=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function u(t,e,r,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new O(o||[]);return n(a,"_invoke",{value:x(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f={};function p(){}function d(){}function h(){}var v={};s(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,i)&&(v=y);var g=h.prototype=p.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,a,c){var s=l(t[n],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==nt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return o("throw",t,a,c)}))}c(s.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function x(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=j(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function j(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,j(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function _(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return d.prototype=h,n(g,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:d,configurable:!0}),d.displayName=s(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function st(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function ut(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){st(i,n,o,a,c,"next",t)}function c(t){st(i,n,o,a,c,"throw",t)}a(void 0)}))}}var lt=function(){var t=ut(ct().mark((function t(e){var r,n;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=I.db("colorpk").collection("colors"),n=[],t.t0=e,t.next="PUBLIC"===t.t0?5:"ANONYMOUS"===t.t0?9:15;break;case 5:return t.next=7,r.find({hidden:!1}).sort({createdDate:-1}).toArray();case 7:case 13:return n=t.sent,t.abrupt("break",16);case 9:return t.next=11,r.find({hidden:!0}).toArray();case 11:return t.next=13,t.sent;case 15:return t.abrupt("break",16);case 16:return t.abrupt("return",n.map((function(t){return{id:t._id,star:t.star,color:t.color,userId:t.createdBy,createdDate:t.createdDate}})));case 17:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ft=function(){var t=ut(ct().mark((function t(e){var r,n;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=I.db("colorpk").collection("colors"),t.next=3,r.find({createdBy:new x.ObjectId(e)}).toArray();case 3:return n=t.sent,t.abrupt("return",n.map((function(t){return t._id})));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),pt=function(){var t=ut(ct().mark((function t(e,r){var n,o,i;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=I.db("colorpk").collection("colors"),o=it({},e),r&&(o.createdBy=new x.ObjectId(r)),t.next=5,n.insertOne(o);case 5:return i=t.sent,t.abrupt("return",i.insertedId);case 7:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),dt=function(){var t=ut(ct().mark((function t(e){var r,n;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=I.db("colorpk").collection("colors"),t.next=3,r.updateOne({_id:new x.ObjectId(e)},{$set:{hidden:!1}});case 3:return n=t.sent,t.abrupt("return",1===n.modifiedCount?0:1);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),ht=function(){var t=ut(ct().mark((function t(e){var r,n;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=I.db("colorpk").collection("colors"),t.next=3,r.updateOne({_id:new x.ObjectId(e)},{$inc:{star:1}});case 3:return n=t.sent,t.abrupt("return",1===n.modifiedCount?0:1);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),vt=function(){var t=ut(ct().mark((function t(e){var r,n;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=I.db("colorpk").collection("colors"),t.next=3,r.deleteOne({_id:new x.ObjectId(e)});case 3:return n=t.sent,t.abrupt("return",1===n.deletedCount?0:1);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),mt=function(){var t=ut(ct().mark((function t(e,r){var n,o;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=I.db("colorpk").collection("users"),t.next=3,n.findOne({oAuthId:r,oAuthType:e});case 3:return o=t.sent,t.abrupt("return",o?{isAdmin:o.isAdmin,userId:o._id.toString()}:null);case 5:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),yt=function(){var t=ut(ct().mark((function t(e){var r,n;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=I.db("colorpk").collection("users"),t.next=3,r.insertOne(e);case 3:return n=t.sent,t.abrupt("return",n.insertedId);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),gt=function(){var t=ut(ct().mark((function t(e){var r;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=I.db("colorpk").collection("users"),t.next=3,r.updateOne({_id:new x.ObjectId(e)},{$set:{lastLogin:new Date}});case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),bt=function(){var t=ut(ct().mark((function t(e){var r,n;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=I.db("colorpk").collection("userSave"),t.next=3,r.find({user:new x.ObjectId(e)}).toArray();case 3:return n=t.sent,t.abrupt("return",n.map((function(t){return t.color})));case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),wt=function(){var t=ut(ct().mark((function t(e,r){var n,o,i;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=I.db("colorpk").collection("userSave"),o={user:new x.ObjectId(e),color:new x.ObjectId(r)},t.next=4,n.updateOne(o,{$setOnInsert:o},{upsert:!0});case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),xt=function(){var t=ut(ct().mark((function t(e,r){var n,o,i;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=I.db("colorpk").collection("userSave"),o={user:new x.ObjectId(e),color:new x.ObjectId(r)},t.next=4,n.deleteOne(o);case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),jt=function(){var t=ut(ct().mark((function t(e){var r,n,o;return ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=I.db("colorpk").collection("userSave"),n={color:new x.ObjectId(e)},t.next=4,r.deleteMany(n);case 4:return o=t.sent,t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function kt(t){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt(t)}function Lt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Lt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function u(t,e,r,o){var i=e&&e.prototype instanceof p?e:p,a=Object.create(i.prototype),c=new O(o||[]);return n(a,"_invoke",{value:x(t,r,c)}),a}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var f={};function p(){}function d(){}function h(){}var v={};s(v,i,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(_([])));y&&y!==e&&r.call(y,i)&&(v=y);var g=h.prototype=p.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function w(t,e){function o(n,i,a,c){var s=l(t[n],t,i);if("throw"!==s.type){var u=s.arg,f=u.value;return f&&"object"==kt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,c)}),(function(t){o("throw",t,a,c)})):e.resolve(f).then((function(t){u.value=t,a(u)}),(function(t){return o("throw",t,a,c)}))}c(s.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function x(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=j(a,r);if(c){if(c===f)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=l(t,e,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===f)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}function j(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,j(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=l(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function k(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(k,this),this.reset(!0)}function _(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:E}}function E(){return{value:void 0,done:!0}}return d.prototype=h,n(g,"constructor",{value:h,configurable:!0}),n(h,"constructor",{value:d,configurable:!0}),d.displayName=s(h,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===d||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,h):(t.__proto__=h,s(t,c,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(w.prototype),s(w.prototype,a,(function(){return this})),t.AsyncIterator=w,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new w(u(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),s(g,c,"Generator"),s(g,i,(function(){return this})),s(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=_,O.prototype={constructor:O,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(L),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;L(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:_(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Ot(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function _t(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ot(i,n,o,a,c,"next",t)}function c(t){Ot(i,n,o,a,c,"throw",t)}a(void 0)}))}}const Et={user:function(t,e){return _t(Lt().mark((function t(){var r,n,o,i,a,c,s,u,l,f,p,d;return Lt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=Y(e),!F(e,!0)||!r){t.next=49;break}if(n=e.session.app.oauth,t.prev=3,o=null,"fb"!==n){t.next=11;break}return t.next=8,v=void 0,v=r.access_token,R()({baseURL:h.G,method:"get",url:"/me",params:{access_token:v,fields:"id,name,picture"}}).then((function(t){var e=t.data;return{oauthId:e.id,name:e.name,img:e.picture.data.url}}));case 8:o=t.sent,t.next=21;break;case 11:if("wb"!==n){t.next=17;break}return t.next=14,U(r);case 14:o=t.sent,t.next=21;break;case 17:if("gh"!==n){t.next=21;break}return t.next=20,B(r);case 20:o=t.sent;case 21:return a=(i=o).name,c=i.oauthId,t.next=24,mt(n,c);case 24:if(!(s=t.sent)){t.next=37;break}return u=s.isAdmin,l=s.userId,e.session.app.dbInfo={id:l,name:a,isAdmin:u},t.next=30,ft(l);case 30:return f=t.sent,t.next=33,bt(l);case 33:return p=t.sent,t.next=36,gt(l);case 36:return t.abrupt("return",{name:a,isAdmin:u,img:o.img||null,likes:p,owns:f});case 37:return t.next=39,yt({oAuthId:c,oAuthType:n,name:a,isAdmin:!1,lastLogin:new Date});case 39:return d=t.sent,e.session.app.dbInfo={id:d,name:a,isAdmin:!1},t.abrupt("return",{name:a,isAdmin:!1,img:N()(o,"picture.data.url",null),likes:[],owns:[]});case 44:return t.prev=44,t.t0=t.catch(3),t.abrupt("return",new et.GraphQLError(t.t0.toString()));case 47:t.next=50;break;case 49:return t.abrupt("return",null);case 50:case"end":return t.stop()}var v}),t,null,[[3,44]])})))()},color:function(t,e){return _t(Lt().mark((function r(){var n,o;return Lt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.category,H(e)||"ANONYMOUS"!==n){r.next=3;break}return r.abrupt("return",new et.GraphQLError("color error: no admin access"));case 3:return r.prev=3,r.next=6,lt(n);case 6:return o=r.sent,r.abrupt("return",o);case 10:return r.prev=10,r.t0=r.catch(3),r.abrupt("return",new et.GraphQLError(r.t0.toString()));case 13:case"end":return r.stop()}}),r,null,[[3,10]])})))()},likeColor:function(t,e){return _t(Lt().mark((function r(){var n,o,i,a,c;return Lt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.input,o=n.id,i=n.willLike,r.prev=2,!F(e)){r.next=12;break}if(a=N()(e,"session.app.dbInfo.id",null),!i){r.next=10;break}return r.next=8,wt(a,o);case 8:r.next=12;break;case 10:return r.next=12,xt(a,o);case 12:if(!i){r.next=17;break}return r.next=15,ht(o);case 15:return c=r.sent,r.abrupt("return",{status:c});case 17:return r.abrupt("return",{status:0});case 20:return r.prev=20,r.t0=r.catch(2),r.abrupt("return",new et.GraphQLError(r.t0.toString()));case 23:case"end":return r.stop()}}),r,null,[[2,20]])})))()},createColor:function(t,e){return _t(Lt().mark((function r(){var n,o,i,a,c;return Lt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.input,o=n.color,rt("#".concat(o))){r.next=4;break}return r.abrupt("return",new et.GraphQLError("create error: invalid color input"));case 4:return i=N()(e,"session.app.dbInfo.id",null),a=F(e)?i:null,r.prev=6,r.next=9,pt({star:(20*Math.random()).toFixed(),color:o,createdBy:void 0,hidden:!a,createdDate:new Date},a);case 9:return c=r.sent,r.abrupt("return",{status:0,data:c});case 13:return r.prev=13,r.t0=r.catch(6),r.abrupt("return",new et.GraphQLError(r.t0.toString()));case 16:case"end":return r.stop()}}),r,null,[[6,13]])})))()},adjudicateColor:function(t,e){return _t(Lt().mark((function r(){var n,o,i,a,c;return Lt().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=t.input,H(e)){r.next=3;break}return r.abrupt("return",new et.GraphQLError("adjudicate error: no admin access"));case 3:if(o=n.id,i=n.willLike,r.prev=4,!i){r.next=10;break}return r.next=8,dt(o);case 8:return a=r.sent,r.abrupt("return",{status:a});case 10:return r.next=12,vt(o);case 12:return c=r.sent,r.next=15,jt(o);case 15:return r.abrupt("return",{status:c});case 18:return r.prev=18,r.t0=r.catch(4),r.abrupt("return",new et.GraphQLError(r.t0.toString()));case 21:case"end":return r.stop()}}),r,null,[[4,18]])})))()}};const St=(0,et.buildSchema)("\n  enum ColorCategory {\n    PUBLIC\n    ANONYMOUS\n  }\n\n  interface MutationResponse {\n    status: Int!\n  }\n\n  type Color {\n    id: ID!\n    star: Int!\n    color: String!\n    userId: ID\n    username: String\n    createdDate: String\n  }\n\n  type User {\n    img: String\n    isAdmin: Boolean\n    name: String\n    likes: [ID!]\n    owns: [ID!]\n  }\n\n  input LikeColorInputType {\n    id: ID!\n    willLike: Boolean!\n  }\n  \n  input CreateColorInputType {\n    color: String!\n  }\n\n  type LikeColorOutputType implements MutationResponse {\n    status: Int!\n  }\n\n  type AdjudicateColorOutputType implements MutationResponse {\n    status: Int!\n  }\n\n  type CreateColorOutputType implements MutationResponse {\n    status: Int!\n    data: ID!\n  }\n\n  type Mutation {\n    likeColor(input: LikeColorInputType!): LikeColorOutputType\n    createColor(input: CreateColorInputType!): CreateColorOutputType\n    adjudicateColor(input: LikeColorInputType!): AdjudicateColorOutputType\n  }\n  \n  type Query {\n    color(category: ColorCategory!): [Color]\n    user: User\n  }\n\n  schema {\n    query: Query\n    mutation: Mutation\n  } \n"),Ct=(0,tt.graphqlHTTP)({schema:St,rootValue:Et,graphiql:!1,pretty:!1}),It=require("react-redux"),At=require("react-router-dom/server");var Nt=r(184);const Pt=require("react-dom/server");var Tt=r(991);const Rt=require("prop-types");var Dt=r.n(Rt);const Gt=require("react"),qt=require("react/jsx-runtime");var Mt="ColorPK v1",Ut="colorpk",Bt="Your Best Color Picker | 全球最大色彩搭配网站 | 颜色搭配 | 艺术设计",Ft="https://repository-images.githubusercontent.com/75897824/b1278e80-8704-11ea-9acf-ac166e4ad4fd";const Yt=function(){return(0,qt.jsxs)(Gt.Fragment,{children:[(0,qt.jsx)("meta",{property:"og:title",content:Mt}),(0,qt.jsx)("meta",{property:"og:type",content:"website"}),(0,qt.jsx)("meta",{property:"og:url",content:"https://react.colorpk.com"}),(0,qt.jsx)("meta",{property:"og:description",content:Bt}),(0,qt.jsx)("meta",{property:"og:site_name",content:Ut}),(0,qt.jsx)("meta",{property:"og:image",content:Ft}),(0,qt.jsx)("meta",{property:"og:image:secure_url",content:Ft}),(0,qt.jsx)("meta",{property:"og:image:type",content:"image/png"}),(0,qt.jsx)("meta",{property:"og:image:width",content:1280}),(0,qt.jsx)("meta",{property:"og:image:height",content:640}),(0,qt.jsx)("meta",{property:"og:image:alt",content:Ut}),(0,qt.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,qt.jsx)("meta",{name:"twitter:site",content:Ut}),(0,qt.jsx)("meta",{name:"twitter:title",content:Mt}),(0,qt.jsx)("meta",{name:"twitter:description",content:Bt}),(0,qt.jsx)("meta",{name:"twitter:image",content:Ft}),(0,qt.jsx)("meta",{name:"twitter:image:width",content:1280}),(0,qt.jsx)("meta",{name:"twitter:image:height",content:640}),(0,qt.jsx)("meta",{name:"twitter:image:alt",content:Ut})]})},Ht=require("serialize-javascript");var Qt=r.n(Ht),zt=function(t){var e=t.title,r=t.style,n=t.script,o=t.children,i=t.csrfToken,a=t.isVertical,c=t.languageCode,s=t.lastBuildDate,u=t.initState;return(0,qt.jsxs)("html",{lang:"en",children:[(0,qt.jsxs)("head",{children:[(0,qt.jsx)("meta",{charSet:"utf-8"}),(0,qt.jsx)("meta",{httpEquiv:"X-UA-Compatible",content:"IE=edge"}),(0,qt.jsx)(Yt,{}),(0,qt.jsx)("title",{children:e}),(0,qt.jsx)("meta",{name:"description",content:"ColorPK | Faster lighter and nicer than colorhunt | 全球最大色彩搭配网站 | 颜色搭配 | 艺术设计"}),(0,qt.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"}),(0,qt.jsx)("meta",{name:"robots",content:"INDEX,FOLLOW"}),(0,qt.jsx)("meta",{name:"keywords",content:"colorpk, colorpicker, color picker, palette, color combination"}),(0,qt.jsx)("link",{rel:"shortcut icon",href:"//dkny.oss-cn-hangzhou.aliyuncs.com/3/fav.ico"}),(0,qt.jsx)("link",{href:r,rel:"stylesheet"}),(0,qt.jsx)("script",{dangerouslySetInnerHTML:{__html:"if(window.location.hostname.indexOf('colorpk.com') > -1){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5LX6LV3');} var initLoadTime = Date.now();window.addEventListener('_COLORPK_SCRIPT_READY', function(){window.dataLayer.push({'scriptLoadingTime': Date.now() - initLoadTime});console.log('server last build: ".concat(s,"');});\n          ")}})]}),(0,qt.jsxs)("body",{children:[(0,qt.jsx)("noscript",{children:(0,qt.jsx)("iframe",{src:"https://www.googletagmanager.com/ns.html?id=GTM-5LX6LV3",height:"0",width:"0",style:{display:"none",visibility:"hidden"}})}),(0,qt.jsx)("div",{id:"app",dangerouslySetInnerHTML:{__html:o}}),(0,qt.jsx)("div",{id:Tt.yY}),(0,qt.jsx)("div",{id:"csrf","data-token":i}),(0,qt.jsx)("script",{dangerouslySetInnerHTML:{__html:"window.".concat(Tt.kl,"=").concat(Qt()(u),"; window.").concat(Tt.CT,'="').concat(c,'"; window.').concat(Tt.jl,"=").concat(a,"; ")}}),(0,qt.jsx)("script",{src:n,type:"text/javascript"})]})]})};zt.propTypes={title:Dt().string.isRequired,isVertical:Dt().bool.isRequired,languageCode:Dt().string.isRequired,lastBuildDate:Dt().string.isRequired,style:Dt().string.isRequired,script:Dt().string.isRequired,children:Dt().string.isRequired,csrfToken:Dt().string.isRequired,initState:Dt().object.isRequired};const $t=zt,Vt={container:"uCFqZ"},Kt=require("react-router-dom"),Xt={selected:"EQXN2",translationText:"nzlHR",rotate:"MaSpR",iconWrapper:"iYPlb",wideScreenOnly:"m_HVm"};const Zt=function(){return(0,qt.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",children:[(0,qt.jsx)("title",{children:"translation"}),(0,qt.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,qt.jsx)("path",{d:" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z "})]})};var Wt=function(t){var e=t.languages,r=t.onChange;return(0,qt.jsx)("div",{className:"navbar-dropdown",children:e.map((function(t){return(0,qt.jsx)("a",{className:"navbar-item",onClick:function(){r(t.code)},children:t.name},t.code)}))})};Wt.propTypes={onChange:Dt().func.isRequired,languages:Dt().array.isRequired};const Jt=Wt;var te=function(t){var e=t.onClick;return(0,qt.jsxs)("a",{role:"nav toggle btn",className:"navbar-burger burger","aria-label":"nav menu","aria-expanded":"false",onClick:e,children:[(0,qt.jsx)("span",{"aria-hidden":"true"}),(0,qt.jsx)("span",{"aria-hidden":"true"}),(0,qt.jsx)("span",{"aria-hidden":"true"})]})};te.propTypes={onClick:Dt().func.isRequired};const ee=te;const re=function(){return(0,Gt.useContext)(Se)};var ne=[],oe={},ie={};function ae(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return ce(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return ce(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ce(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}[{code:"en",name:"English",data:{language:"Language",popular:"Popular",latest:"Latest",more:"More",about:"About",newColor:"New Color",navLogin:"Login",reportIssue:"Report an issue",download:"Download",submit:"Submit",reset:"Reset",return:"Return",profile:"Profile",like:"Like",admin:"Admin",logOut:"Log Out",facebook:"FaceBook",twitter:"Twitter",email:"E-Mail",noColorsToShow:"No colors to display",undefinedColorId:"Color ID is not defined"}},{code:"zh",name:"简体中文",data:{language:"多语言",popular:"最热",latest:"最新",more:"更多",about:"关于",newColor:"创建新颜色",navLogin:"登录",reportIssue:"报告错误",download:"下载",submit:"添加",reset:"重置",return:"返回",profile:"我的颜色",like:"我的收藏",admin:"管理员",logOut:"注销",facebook:"脸书",twitter:"推特",email:"电邮",noColorsToShow:"没有可以显示的颜色",undefinedColorId:"颜色ID未定义"}},{code:"ja",name:"日本語",data:{language:"言語",popular:"人気のある",latest:"最新",more:"もっと",about:"約",newColor:"色をつくる",navLogin:"ログイン",reportIssue:"問題を報告する",download:"ダウンロード",submit:"提出する",reset:"リセット",return:"戻る",profile:"プロフィール",like:"好む",admin:"管理者",logOut:"サインアウト",facebook:"FaceBook",twitter:"さえずり",email:"Eメール",noColorsToShow:"表示する色がありません",undefinedColorId:"IDが定義されていません"}},{code:"ko",name:"한국어",data:{language:"언어",popular:"인기 있는",latest:"최근",more:"더",about:"약",newColor:"몹시 떠들어 대다",navLogin:"로그인",reportIssue:"보고 문제",download:"다운로드",submit:"제출하다",reset:"다시 놓기",return:"반환",profile:"윤곽",like:"인기 있는 말",admin:"관리자",logOut:"로그 아웃하다",facebook:"페이스 북",twitter:"지저귀다",email:"이메일",noColorsToShow:"표시 할 색상이 없습니다",undefinedColorId:"ID가 정의되지 않았습니다"}},{code:"es",name:"Español",data:{language:"idioma",popular:"popular",latest:"más reciente",more:"Más",about:"acerca de",newColor:"crear nuevo",navLogin:"Iniciar sesión",reportIssue:"informe de problema",download:"descargar",submit:"enviar",reset:"Reiniciar",return:"regreso",profile:"perfil",like:"favorita",admin:"administración",logOut:"cerrar sesión",facebook:"Facebook",twitter:"gorjeo",email:"correo electrónico",noColorsToShow:"No hay color para mostrar",undefinedColorId:"ID no está definido"}}].forEach((function(t){ne.push({code:t.code,name:t.name}),oe[t.code]=t.data,ie[t.code]=!0}));var se=(0,Gt.createContext)(),ue=function(t){var e=t.children,r=t.initLang,n=t.onChange,o=ae((0,Gt.useState)(r),2),i=o[0],a=o[1];return(0,Gt.useEffect)((function(){n(i)}),[i]),(0,qt.jsx)(se.Provider,{value:[oe[i],a],children:e})};ue.propTypes={children:Dt().element.isRequired,initLang:Dt().string,onChange:Dt().func};const le=function(){return(0,Gt.useContext)(se)};function fe(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return pe(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pe(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var de=Xt.selected,he=function(t){var e=t.detail,r=t.likeNum,n=t.weiboUrl,o=t.githubUrl,i=t.facebookUrl,a=t.languages,c=t.onLogout,s=(0,Kt.useLocation)().pathname,u=fe((0,Gt.useState)(!1),2),l=u[0],f=u[1],p=fe(re(),2),d=p[0],h=p[1],v=fe(le(),2),m=v[0],y=v[1],g=Boolean(e),b=g&&e.isAdmin,w=g&&e.img,x=w||"".concat(Tt.Qi,"/icon.png"),j="/popular"===s,k=["/","/latest"].includes(s),L=["/like","/portfolio"].includes(s),O="/like"===s,_="/new"===s,E=function(){f(!1)},S=function(){f(!1),window.scrollTo(0,0)};return(0,qt.jsxs)("nav",{className:"navbar is-fixed-top",role:"navigation","aria-label":"main navigation",children:[(0,qt.jsxs)("div",{className:"navbar-brand",children:[(0,qt.jsx)("div",{title:"click to rotate","aria-label":"click to rotate",className:"navbar-item ".concat(Xt.iconWrapper),onClick:function(){f(!1),h(!d)},children:(0,qt.jsx)("img",{src:x,className:"".concat(w||d?"":Xt.rotate),alt:"icon"})}),(0,qt.jsx)(ee,{onClick:function(){return f((function(t){return!t}))}})]}),(0,qt.jsxs)("div",{className:"navbar-menu ".concat(l?"is-active":""),children:[(0,qt.jsxs)("div",{className:"navbar-start",children:[g?(0,qt.jsxs)("div",{className:"navbar-item has-dropdown is-hoverable",children:[(0,qt.jsx)("a",{className:"navbar-link ".concat(L?de:""),children:e.name}),(0,qt.jsxs)("div",{className:"navbar-dropdown",children:[(0,qt.jsx)(Kt.Link,{className:"navbar-item",to:"/portfolio",onClick:S,children:m.profile}),(0,qt.jsx)(Kt.Link,{to:"/like",className:"navbar-item",onClick:S,children:m.like}),b&&(0,qt.jsx)(Kt.Link,{to:"/adminpanel",className:"navbar-item",onClick:S,children:m.admin})]})]}):(0,qt.jsxs)(Kt.Link,{to:"/like",className:"navbar-item ".concat(O?de:""),onClick:S,children:[m.like,r>0&&" (".concat(r,")")]}),(0,qt.jsx)(Kt.Link,{to:"/popular",className:"navbar-item ".concat(j?de:""),onClick:E,children:m.popular}),(0,qt.jsx)(Kt.Link,{to:"/latest",className:"navbar-item ".concat(k?de:""),onClick:E,children:m.latest}),(0,qt.jsxs)("div",{className:"navbar-item has-dropdown is-hoverable ".concat(Xt.wideScreenOnly),children:[(0,qt.jsx)("a",{className:"navbar-link",children:m.more}),(0,qt.jsxs)("div",{className:"navbar-dropdown",children:[(0,qt.jsx)("a",{className:"navbar-item",href:"//www.colorpk.com",children:"ColorPK v2.0"}),(0,qt.jsx)("a",{className:"navbar-item",href:"//www.colorpk.com/about",children:m.about}),(0,qt.jsx)("hr",{className:"navbar-divider"}),(0,qt.jsx)("a",{className:"navbar-item",href:"//github.com/im6/vp/issues",children:m.reportIssue})]})]}),(0,qt.jsxs)("div",{className:"navbar-item has-dropdown is-hoverable",children:[(0,qt.jsxs)("a",{className:"navbar-link",children:[(0,qt.jsx)(Zt,{}),(0,qt.jsx)("span",{className:Xt.translationText,children:m.language})]}),(0,qt.jsx)(Jt,{languages:a,onChange:y})]})]}),(0,qt.jsxs)("div",{className:"navbar-end",children:[!g&&(0,qt.jsxs)("div",{className:"navbar-item has-dropdown is-hoverable",children:[(0,qt.jsx)("a",{className:"navbar-link",children:m.navLogin}),(0,qt.jsxs)("div",{className:"navbar-dropdown",children:[(0,qt.jsx)("a",{className:"navbar-item",href:n,children:"微博"}),(0,qt.jsx)("a",{className:"navbar-item",href:o,children:"GitHub"}),i&&(0,qt.jsx)("a",{className:"navbar-item",href:i,children:"FaceBook"})]})]}),(0,qt.jsx)("div",{className:"navbar-item",children:(0,qt.jsxs)("div",{className:"buttons",children:[g&&(0,qt.jsx)(Kt.Link,{className:"button is-danger",to:"/",onClick:function(){c(),E()},children:m.logOut}),!_&&(0,qt.jsx)(Kt.Link,{to:"/new",className:"button is-primary",onClick:S,children:m.newColor})]})})]})]})]})};he.propTypes={detail:Dt().object,weiboUrl:Dt().string,githubUrl:Dt().string,facebookUrl:Dt().string,likeNum:Dt().number,languages:Dt().array.isRequired,onLogout:Dt().func.isRequired};const ve=he;const me=(0,It.connect)((function(t){var e=t.user,r=t.color,n=e.detail,o=e.weiboUrl,i=e.githubUrl,a=e.facebookUrl;return{detail:n,likeNum:r.liked.length,languages:ne,weiboUrl:o,githubUrl:i,facebookUrl:a}}),(function(t){return{onLogout:function(){var e=(0,Nt.createAction)("user/logoff");t(e())}}}))(ve);var ye=function(){return(0,qt.jsx)("div",{className:"spinContainer",children:(0,qt.jsx)("div",{className:"spinLoader"})})};const ge=(0,Gt.memo)(ye);function be(t){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},be(t)}function we(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(o=n.key,i=void 0,i=function(t,e){if("object"!==be(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!==be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(o,"string"),"symbol"===be(i)?i:String(i)),n)}var o,i}function xe(t,e){return xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},xe(t,e)}function je(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ke(t);if(e){var o=ke(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===be(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function ke(t){return ke=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ke(t)}var Le=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&xe(t,e)}(i,t);var e,r,n,o=je(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=o.call(this,t)).state={loading:!0},e}return e=i,(r=[{key:"componentDidMount",value:function(){this.setState({loading:!1})}},{key:"render",value:function(){var t=this.state.loading,e=this.props.children;return(0,qt.jsxs)("div",{className:Vt.container,children:[(0,qt.jsx)(me,{}),t?(0,qt.jsx)(ge,{}):e]})}}])&&we(e.prototype,r),n&&we(e,n),Object.defineProperty(e,"prototype",{writable:!1}),i}(Gt.Component);Le.propTypes={children:Dt().node};const Oe=Le;function _e(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,c=[],s=!0,u=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;s=!1}else for(;!(s=(n=i.call(r)).done)&&(c.push(n.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Ee(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ee(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ee(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}var Se=(0,Gt.createContext)(),Ce=function(t){var e=t.children,r=t.initVertical,n=t.onChange,o=_e((0,Gt.useState)(r),2),i=o[0],a=o[1];return(0,Gt.useEffect)((function(){n(i)}),[i]),(0,qt.jsx)(Se.Provider,{value:[i,a],children:(0,qt.jsx)(Oe,{children:e})})};Ce.propTypes={children:Dt().node,initVertical:Dt().bool,onChange:Dt().func};var Ie=r(287);const Ae=Ie.keys().reduce((function(t,e){return t[e.replace(/\.js$/,"").replace(/^.\//,"")]=Ie(e).default,t}),{}),Ne=function(t,e){var r,n=F(t,!0),o=t.cookies[Tt.CT],i=t.cookies[Tt.jl],a=o&&ie[o]?o:Tt.$q,c=["0","1"].includes(i)?"1"===i:Tt.ZA;if(n)r={loading:!0,detail:{name:"loading",isAdmin:H(t)}};else{var s=(0,P.v1)();t.session.app={oauthState:s},r={loading:!0,detail:null,weiboUrl:D("wb",s),githubUrl:D("gh",s),facebookUrl:null}}var u=(0,Nt.configureStore)({reducer:Ae,preloadedState:{user:r,color:{loading:!0,colorDef:{},liked:{},colorIdAllByDate:[],colorIdAllByStar:[],colorIdByMyOwn:[]}}}),l=(0,qt.jsx)(At.StaticRouter,{location:t.url,children:(0,qt.jsx)(It.Provider,{store:u,children:(0,qt.jsx)(ue,{initLang:a,children:(0,qt.jsx)(Ce,{initVertical:c})})})}),f=(0,qt.jsx)($t,{title:"".concat("ColorPK | Your Best Color Picker"),languageCode:a,isVertical:c,style:"".concat(h._7,"/main.css"),script:"".concat(h._7,"/main.js"),csrfToken:t.csrfToken(),lastBuildDate:"8/1/2023, 10:18:30 PM EST",initState:u.getState(),children:(0,Pt.renderToString)(l)}),p=(0,Pt.renderToStaticMarkup)(f);e.status(200),e.send("<!DOCTYPE html>".concat(p))};var Pe=i()();C(),Pe.set("trust proxy",!0),Pe.use(n()({contentSecurityPolicy:!1,crossOriginEmbedderPolicy:!1})),Pe.use((0,a.json)()),Pe.use((0,a.urlencoded)({extended:!1})),Pe.use(s()()),Pe.use(w);var Te=r(619).Z;h.TM.forEach((function(t){Pe.get(t,Te)})),Pe.get("/_ah/:action",(function(t,e){var r=t.params.action;e.json({status:"".concat(r," - ok")})})),Pe.use(J),Pe.post("/graphql",Ct),Pe.get("/auth/logout",(function(t,e){var r=N()(t,"session.app.dbInfo.name","unknown");console.log("logoff (".concat(r,"), delete session")),delete t.session.app;var n=(0,P.v1)();t.session.app={oauthState:n},e.json({weiboUrl:D("wb",n),githubUrl:D("gh",n),facebookUrl:D("fb",n)})})),Pe.get("/auth/:oauth",V),["/","/latest","/popular","/color/:id","/new","/like"].forEach((function(t){Pe.get(t,Ne)})),Pe.get("/portfolio",(function(t,e,r){F(t)?r():r(401)}),Ne),Pe.get("/adminpanel",(function(t,e,r){H(t)?r():r(403)}),Ne),Pe.use((function(t,e){console.error("Error: 404, ".concat(t.url," not found")),e.status(400).sendFile(X)})),Pe.use((function(t,e,r,n){console.error("Error: ".concat(t.toString(),", ").concat(e.url)),"POST"===e.method?r.status(400).json({errors:!0}):r.status(400).sendFile(X)}));Pe.listen(h.px,(function(){return console.log("app (mode: ".concat("production",") is running on: http://localhost:").concat(h.px))})).timeout=5e3,(0,t.exec)("curl ifconfig.me",(function(t,e,r){t?console.error(r):console.log("public IP addr: ".concat(e))}))})()})();