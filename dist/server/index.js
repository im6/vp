(()=>{var e={991:(e,t,r)=>{"use strict";r.d(t,{$q:()=>i,CT:()=>l,Qi:()=>c,Xx:()=>s,ZA:()=>a,jl:()=>u,kl:()=>d,yY:()=>o});var n=r(147).version,o="temp",i="en",a=!0,c="//dkny.oss-cn-hangzhou.aliyuncs.com/2",s="https://cdn.jsdelivr.net/gh/im6/vp@v".concat(n,"/dist/public"),u="canvas",l="lang",d="_REDUXSTATE_"},598:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n,o=r(984),i=r(133),a=r.n(i);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=(0,o.handleActions)((c(n={},"admin/getList",(function(e){return a()(e,(function(e){e.loading=!0}))})),c(n,"admin/getList/success",(function(e,t){return a()(e,(function(e){e.loading=!1,e.list=t.payload}))})),c(n,"admin/getList/fail",(function(e){return a()(e,(function(e){e.loading=!1,e.list=[]}))})),c(n,"admin/decideColor",(function(e,t){var r=t.payload;return a()(e,(function(t){t.list=e.list.filter((function(e){return e.id!==r.id}))}))})),n),{list:null,loading:!1})},616:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n,o=r(984),i=r(133),a=r.n(i);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=(0,o.handleActions)((c(n={},"color/get",(function(e){return a()(e,(function(e){e.loading=!0}))})),c(n,"color/get/success",(function(e,t){var r=t.payload,n=[],o={};r.forEach((function(e){n.push(e.id),o[e.id]=e}));var i=r.sort((function(e,t){return t.star-e.star})).map((function(e){return e.id}));return a()(e,(function(e){Object.assign(e,{colorIdAllByDate:n,colorIdAllByStar:i,colorDef:o,loading:!1})}))})),c(n,"color/get/fail",(function(e){return a()(e,(function(e){e.loading=!1,e.colorIdAllByDate=[],e.colorIdAllByStar=[]}))})),c(n,"color/toggleLike",(function(e,t){var r=t.payload,n=r.willLike,o=r.id;return a()(e,(function(e){n?e.liked[o]=!0:delete e.liked[o],e.colorDef[o].star+=n?1:-1}))})),c(n,"color/addNew/success",(function(e,t){var r=t.payload,n=r.id;return a()(e,(function(e){e.colorDef[n]=r,e.colorIdAllByDate.unshift(n),e.colorIdAllByStar.push(n)}))})),c(n,"color/set/likes",(function(e,t){var r=t.payload;return a()(e,(function(e){var t=r.reduce((function(e,t){return e[t]=!0,e}),{});e.liked=t}))})),c(n,"color/set/owns",(function(e,t){var r=t.payload;return a()(e,(function(e){e.colorIdByMyOwn=r}))})),n),{loading:!1,colorDef:{},liked:{},colorIdAllByDate:[],colorIdAllByStar:[],colorIdByMyOwn:[]})},141:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var n,o=r(984),i=r(133),a=r.n(i);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s={type:null,message:null,visible:!1};const u=(0,o.handleActions)((c(n={},"modal/cycle/show",(function(e){return a()(e,(function(e){e.visible=!0}))})),c(n,"modal/cycle/hide",(function(e){return a()(e,(function(e){e.visible=!1}))})),c(n,"modal/cycle/reset",(function(){return s})),c(n,"modal/admin/getList/fail",(function(){return{type:"danger",message:"Admin data error",visible:!1}})),c(n,"modal/admin/decideColor/success",(function(){return{type:"success",message:"Adjudicate successfully",visible:!1}})),c(n,"modal/admin/decideColor/fail",(function(){return{type:"danger",message:"Adjudicate failed",visible:!1}})),c(n,"modal/color/get/fail",(function(){return{type:"danger",message:"Get color data error.",visible:!1}})),c(n,"modal/color/copy",(function(){return{type:"success",message:"Copy to clipboard successfully",visible:!1}})),c(n,"modal/color/addNew/success",(function(){return{type:"success",message:"Create color successfully, thanks.",visible:!1}})),c(n,"modal/color/addNew/fail",(function(){return{type:"danger",message:"Create color failed.",visible:!1}})),c(n,"modal/color/addNew/invalid",(function(){return{type:"danger",message:"Invalid color value.",visible:!1}})),c(n,"modal/color/download",(function(){return{type:"link",message:"Downloading ...",visible:!1}})),c(n,"modal/user/logoff",(function(){return{type:"info",message:"Logout successfully.",visible:!1}})),c(n,"modal/user/auth/fail",(function(){return{type:"danger",message:"Log in failed",visible:!1}})),c(n,"modal/user/greet",(function(e,t){var r=t.payload;return{type:"success",message:"Welcome back, ".concat(r),visible:!1}})),n),s)},137:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n,o=r(984),i=r(133),a=r.n(i);function c(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const s=(0,o.handleActions)((c(n={},"user/auth",(function(e){return a()(e,(function(e){e.loading=!0}))})),c(n,"user/auth/success",(function(e,t){var r=t.payload;return a()(e,(function(e){e.loading=!1,e.detail=r}))})),c(n,"user/auth/fail",(function(e){return a()(e,(function(e){e.loading=!1,e.detail=null}))})),c(n,"user/logoff",(function(e){return a()(e,(function(e){e.detail=null}))})),c(n,"user/logoff/success",(function(e,t){var r=t.payload;return a()(e,(function(e){Object.assign(e,r,{detail:null})}))})),n),{detail:null,weiboUrl:null,githubUrl:null,facebookUrl:null,loading:!1})},470:(e,t,r)=>{"use strict";r.d(t,{Bu:()=>y,Fj:()=>h,Fq:()=>p,G:()=>s,G4:()=>d,GT:()=>m,Mh:()=>c,Ov:()=>b,QA:()=>v,TM:()=>k,X:()=>l,ZK:()=>g,_7:()=>w,_h:()=>f,bJ:()=>a,e8:()=>x,px:()=>i,xZ:()=>u});var n=r(991);var o=process.env,i=o.PORT,a=o.SESSION_SECRET,c=o.CSRF_EXCEPTION,s=o.FB_API_URL,u=o.FB_APP_KEY,l=o.FB_APP_SECRET,d=o.FB_REDIRECT_URL,p=o.WB_API_URL,f=o.WB_APP_KEY,h=o.WB_APP_SECRET,m=o.WB_REDIRECT_URL,g=o.GH_API_URL,v=o.GH_APP_KEY,y=o.GH_APP_SECRET,b=o.GH_REDIRECT_URL,w=n.Xx,x="./".concat("dist","/server"),k=["/robots.txt","/sitemap.xml","/favicon.ico"];c||console.log("No CSRF exception defined"),i||(console.error("No port defined."),process.exit(1))},619:(e,t,r)=>{"use strict";r.d(t,{Z:()=>c});var n=r(17),o=r.n(n),i=r(470),a=i.TM.reduce((function(e,t){return e[t]=!0,e}),{});const c=function(e,t,r){var n=e.url;if(Object.prototype.hasOwnProperty.call(a,n)){var c=o().resolve(process.cwd(),"".concat(i.e8).concat(n));t.sendFile(c)}else r(404)}},287:(e,t,r)=>{var n={"./admin.js":598,"./color.js":616,"./modal.js":141,"./user.js":137};function o(e){var t=i(e);return r(t)}function i(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=287},133:e=>{"use strict";e.exports=require("immer")},984:e=>{"use strict";e.exports=require("redux-actions")},17:e=>{"use strict";e.exports=require("path")},147:e=>{"use strict";e.exports=JSON.parse('{"name":"vp","version":"1.29.0","description":"source code of react.colorpk.com","engines":{"node":">= 16.x"},"scripts":{"dev":"webpack --config ./webpack/develop.js","lint":"eslint ./webpack ./src","test":"jest --coverage","t":"yarn lint && yarn test","build":"webpack --config ./webpack/production.js","start":"node dist/server"},"repository":"git+https://github.com/im6/vp.git","author":"im6","license":"ISC","bugs":{"url":"https://github.com/im6/vp/issues"},"homepage":"https://github.com/im6/vp#readme","devDependencies":{"@babel/core":"^7.19.1","@babel/preset-env":"7.19.1","@babel/preset-react":"^7.18.6","@testing-library/react":"^13.4.0","autoprefixer":"^10.4.11","babel-loader":"^8.2.5","bulma":"^0.9.4","clean-webpack-plugin":"^4.0.0","compression-webpack-plugin":"^10.0.0","copy-webpack-plugin":"^11.0.0","css-loader":"^6.7.1","css-minimizer-webpack-plugin":"^4.1.0","dotenv":"^16.0.2","eslint":"^8.23.1","eslint-config-airbnb":"^19.0.4","eslint-config-prettier":"^8.5.0","eslint-plugin-import":"^2.26.0","eslint-plugin-jest":"^27.0.4","eslint-plugin-jsx-a11y":"^6.6.1","eslint-plugin-prettier":"^4.2.1","eslint-plugin-react":"7.31.8","eslint-plugin-react-hooks":"^4.6.0","jest":"^29.0.3","jest-environment-jsdom":"^29.0.3","js-cookie":"^3.0.1","mini-css-extract-plugin":"^2.6.1","node-sass":"^7.0.3","postcss":"^8.4.16","postcss-loader":"^7.0.1","prettier":"^2.7.1","prop-types":"^15.8.1","react-color":"^2.19.3","redux-logger":"^3.0.6","redux-observable":"^2.0.0","rxjs":"^7.5.6","sass-loader":"^13.0.2","webpack":"^5.74.0","webpack-cli":"^4.10.0","webpack-node-externals":"^3.0.0"},"dependencies":{"axios":"^0.27.2","body-parser":"^1.20.0","connect-redis":"^6.1.3","cookie-parser":"^1.4.6","csurf":"^1.11.0","express":"^4.18.1","express-graphql":"^0.12.0","express-session":"^1.17.3","graphql":"^16.6.0","helmet":"^6.0.0","immer":"^9.0.15","lodash.get":"^4.4.2","mysql":"^2.18.1","react":"^18.2.0","react-dom":"^18.2.0","react-redux":"^8.0.2","react-router-dom":"^6.4.0","redis":"^4.3.1","redux":"^4.2.0","redux-actions":"^2.6.5","regenerator-runtime":"^0.13.9","serialize-javascript":"^6.0.0","uuid":"^9.0.0"},"prettier":{"endOfLine":"auto","trailingComma":"es5","tabWidth":2,"semi":true,"singleQuote":true},"babel":{"presets":["@babel/preset-env",["@babel/preset-react",{"runtime":"automatic"}]]},"eslintConfig":{"extends":["airbnb","prettier","plugin:react-hooks/recommended"],"plugins":["react","jsx-a11y","import","prettier","jest"],"rules":{"prettier/prettier":2,"import/no-extraneous-dependencies":0,"react-hooks/rules-of-hooks":"error","react-hooks/exhaustive-deps":"warn","import/no-unresolved":[2,{"ignore":["^components/"]}],"no-param-reassign":["error",{"props":true,"ignorePropertyModificationsFor":["acc","req","res","draft"]}]},"env":{"browser":true,"jest/globals":true}},"jest":{"verbose":false,"testEnvironment":"jsdom","clearMocks":true,"moduleDirectories":["node_modules","<rootDir>/src/testing"],"moduleNameMapper":{"\\\\.(jpg|jpeg|png|gif|eot|otf|webp|svg|ttf|woff|woff2|mp4|webm|wav|mp3|m4a|aac|oga)$":"<rootDir>/src/testing/fileMock.js","\\\\.(css|sass)$":"<rootDir>/src/testing/styleMock.js","^components/(.*)":"<rootDir>/src/components/$1"},"coverageDirectory":"coverage","coverageThreshold":{"global":{"branches":100,"functions":100,"lines":100,"statements":-10}}},"browserslist":["defaults","cover 99.5%"]}')}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={exports:{}};return e[n](i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";const e=require("child_process"),t=(require("regenerator-runtime/runtime"),require("helmet"));var n=r.n(t);const o=require("express");var i=r.n(o);const a=require("body-parser"),c=require("cookie-parser");var s=r.n(c);const u=require("redis"),l=require("express-session");var d=r.n(l);const p=require("connect-redis");var f=r.n(p),h=r(470),m=process.env,g=m.REDIS_HOST,v=m.REDIS_PORT,y=m.REDIS_PASSWORD;g&&v&&y||(console.error("missing redis connection info"),process.exit(1));var b=f()(d()),w=(0,u.createClient)({url:"redis://:".concat(y,"@").concat(g,":").concat(v),legacyMode:!0});w.on("error",(function(e){console.error(e),process.exit(1)})),w.on("reconnecting",(function(e,t){console.log("reconnecting, attempt: ".concat(t))})),w.on("connect",(function(){console.log("Redis connect successfully.")})),w.connect();const x=d()({store:new b({client:w}),secret:h.bJ,resave:!1,saveUninitialized:!1}),k=require("lodash.get");var j=r.n(k);const _=require("uuid"),E=require("axios");var L=r.n(E),S=function(e,t){if("fb"===e)return"https://www.facebook.com/v3.3/dialog/oauth?client_id=".concat(h.xZ,"&response_type=code&state=").concat(t,"&redirect_uri=").concat(h.G4);if("wb"===e)return"https://api.weibo.com/oauth2/authorize?client_id=".concat(h._h,"&scope=follow_app_official_microblog&state=").concat(t,"&redirect_uri=").concat(h.GT);if("gh"===e)return"https://github.com/login/oauth/authorize?client_id=".concat(h.QA,"&state=").concat(t,"&redirect_uri=").concat(h.Ov);throw new Error},C=function(e){var t={client_id:h.xZ,client_secret:h.X,code:e,redirect_uri:h.G4};return L()({baseURL:h.G,method:"get",url:"/oauth/access_token",params:t}).then((function(e){var t=e.data;return{access_token:t.access_token,expires_in:t.expires_in}}))},O=function(e){var t={client_id:h._h,client_secret:h.Fj,code:e,redirect_uri:h.GT,grant_type:"authorization_code"};return L()({baseURL:h.Fq,method:"post",url:"/oauth2/access_token",params:t}).then((function(e){var t=e.data,r=t.access_token,n=t.expires_in;return{uid:t.uid,access_token:r,expires_in:n}}))},T=function(e){var t={client_id:h.QA,client_secret:h.Bu,code:e,redirect_uri:h.Ov};return L()({method:"post",url:"https://github.com/login/oauth/access_token",headers:{Accept:"application/json"},params:t}).then((function(e){return{access_token:e.data.access_token}}))},I=function(e){var t=e.uid,r=e.access_token;return L()({baseURL:h.Fq,method:"get",url:"/2/users/show.json",params:{uid:t,access_token:r}}).then((function(e){var t=e.data;return{oauthId:t.id,name:t.name,img:t.profile_image_url}}))},N=function(e){var t=e.access_token;return L()({baseURL:h.ZK,method:"get",url:"/user",headers:{Authorization:"token ".concat(t)}}).then((function(e){var t=e.data;return{oauthId:t.id,name:t.name||t.login,img:t.avatar_url}}))},A=function(e,t){return Boolean(j()(e,"session.app.isAuth",!1)&&(t||j()(e,"session.app.dbInfo.id",null)))},R=function(e){return j()(e,"session.app.tokenInfo",null)},P=function(e){return A(e)&&j()(e,"session.app.dbInfo.isAdmin",!1)};function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function D(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */D=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new j(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=w(a,r);if(c){if(c===l)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=u(e,t,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(e,r,a),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l={};function d(){}function p(){}function f(){}var h={};c(h,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(_([])));g&&g!==t&&r.call(g,o)&&(h=g);var v=f.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function n(o,i,a,c){var s=u(e[o],e,i);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==q(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=f,c(v,"constructor",f),c(f,"constructor",p),p.displayName=c(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(b.prototype),c(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(v),c(v,a,"Generator"),c(v,o,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=_,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}function M(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}var U=function(){var e,t=(e=D().mark((function e(t,r){var n,o,i,a,c;return D().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=j()(t,"query.code",null),o=j()(t,"query.state",null),i=j()(t,"params.oauth",null),a=j()(t,"session.app.oauthState",null),!n||!o||o!==a){e.next=29;break}if(console.log("redirected by ".concat(i," auth...")),c=null,"fb"!==i){e.next=13;break}return e.next=10,C(n);case 10:c=e.sent,e.next=26;break;case 13:if("wb"!==i){e.next=19;break}return e.next=16,O(n);case 16:c=e.sent,e.next=26;break;case 19:if("gh"!==i){e.next=25;break}return e.next=22,T(n);case 22:c=e.sent,e.next=26;break;case 25:throw new Error;case 26:t.session.app=c?{oauth:i,isAuth:!0,tokenInfo:c}:{isAuth:!1,authError:"get token failed."},e.next=31;break;case 29:console.log("inconsistant session, error msg in session"),t.session.app={isAuth:!1,authError:"Sorry, something error, please try again."};case 31:r.redirect("/");case 32:case"end":return e.stop()}}),e)})),function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){M(i,n,o,a,c,"next",e)}function c(e){M(i,n,o,a,c,"throw",e)}a(void 0)}))});return function(e,r){return t.apply(this,arguments)}}(),B=r(17),F=r.n(B)().resolve(process.cwd(),"".concat(h.e8,"/error.html"));const G=require("csurf");var H=void 0,Q=r.n(G)()();const W=function(){for(var e=H,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];j()(r[0],"body._csrf",null)===h.Mh?(console.log("csrf exception"),r[2]()):Q.apply(e,r)},Y=require("express-graphql"),z=require("graphql"),V=require("mysql");var X=r.n(V),K=process.env,Z=K.SQL_HOST,$=K.SQL_PORT,J=K.SQL_USERNAME,ee=K.SQL_PASSWORD,te=K.SQL_DATABASE,re=X().createPool({connectionLimit:4,multipleStatements:!1,host:Z,port:$,user:J,password:ee,database:te});re.query("SELECT 1 + 1 AS solution",(function(e,t){(e||2!==t[0].solution)&&(console.error(e),process.exit(1)),console.log("MySQL connect successfully.")}));const ne=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return new Promise((function(r,n){re.query(e,t,(function(e,t){e?(console.error(e),n(e)):r(t)}))}))};var oe=function(e){return function(e){return/^(#[a-f0-9]{6}){4}$/.test(e)}(e)&&function(e){var t={cnt:0},r=[e.substring(0,7),e.substring(7,14),e.substring(14,21),e.substring(21)];return r.forEach((function(e){Object.prototype.hasOwnProperty.call(t,e)||(t[e]=!0,t.cnt+=1)})),t.cnt===r.length}(e)};function ie(e){return ie="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ie(e)}function ae(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ae=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",a=n.toStringTag||"@@toStringTag";function c(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,r){return e[t]=r}}function s(e,t,r,n){var o=t&&t.prototype instanceof d?t:d,i=Object.create(o.prototype),a=new j(n||[]);return i._invoke=function(e,t,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return E()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var c=w(a,r);if(c){if(c===l)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var s=u(e,t,r);if("normal"===s.type){if(n=r.done?"completed":"suspendedYield",s.arg===l)continue;return{value:s.arg,done:r.done}}"throw"===s.type&&(n="completed",r.method="throw",r.arg=s.arg)}}}(e,r,a),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var l={};function d(){}function p(){}function f(){}var h={};c(h,o,(function(){return this}));var m=Object.getPrototypeOf,g=m&&m(m(_([])));g&&g!==t&&r.call(g,o)&&(h=g);var v=f.prototype=d.prototype=Object.create(h);function y(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){function n(o,i,a,c){var s=u(e[o],e,i);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==ie(d)&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,c)}),(function(e){n("throw",e,a,c)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return n("throw",e,a,c)}))}c(s.arg)}var o;this._invoke=function(e,r){function i(){return new t((function(t,o){n(e,r,t,o)}))}return o=o?o.then(i,i):i()}}function w(e,t){var r=e.iterator[t.method];if(void 0===r){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=u(r,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,l;var o=n.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function x(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function j(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function _(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:E}}function E(){return{value:void 0,done:!0}}return p.prototype=f,c(v,"constructor",f),c(f,"constructor",p),p.displayName=c(f,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,c(e,a,"GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(b.prototype),c(b.prototype,i,(function(){return this})),e.AsyncIterator=b,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new b(s(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(v),c(v,a,"Generator"),c(v,o,(function(){return this})),c(v,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=_,j.prototype={constructor:j,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),s=r.call(i,"finallyLoc");if(c&&s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),k(r),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;k(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:_(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},e}function ce(e,t,r,n,o,i,a){try{var c=e[i](a),s=c.value}catch(e){return void r(e)}c.done?t(s):Promise.resolve(s).then(n,o)}function se(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ce(i,n,o,a,c,"next",e)}function c(e){ce(i,n,o,a,c,"throw",e)}a(void 0)}))}}const ue={user:function(e,t){return se(ae().mark((function e(){var r,n,o,i,a,c,s,u,l,d,p,f,m,g;return ae().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=R(t),!A(t,!0)||!r){e.next=49;break}if(n=t.session.app.oauth,e.prev=3,o=null,"fb"!==n){e.next=11;break}return e.next=8,v=void 0,v=r.access_token,L()({baseURL:h.G,method:"get",url:"/me",params:{access_token:v,fields:"id,name,picture"}}).then((function(e){var t=e.data;return{oauthId:t.id,name:t.name,img:t.picture.data.url}}));case 8:o=e.sent,e.next=21;break;case 11:if("wb"!==n){e.next=17;break}return e.next=14,I(r);case 14:o=e.sent,e.next=21;break;case 17:if("gh"!==n){e.next=21;break}return e.next=20,N(r);case 20:o=e.sent;case 21:return a=(i=o).name,c=i.oauthId,e.next=24,ne("SELECT * FROM colorpk_user WHERE oauth = ? AND oauth_id = ?",[n,c]);case 24:if(1!==(s=e.sent).length){e.next=36;break}return u=s[0],l=u.is_admin,d=u.id,t.session.app.dbInfo={id:d,name:a,isAdmin:l||!1},e.next=30,ne("SELECT color_id FROM colorpk_userlike WHERE user_id= ?",[d]);case 30:return p=e.sent,e.next=33,ne("SELECT a.id FROM colorpk_color a WHERE a.user_id=?",[d]);case 33:return f=e.sent,ne("UPDATE colorpk_user SET last_login=NOW() WHERE id=?",[d]),e.abrupt("return",{name:a,isAdmin:l||!1,img:o.img||null,likes:p.map((function(e){return e.color_id})),owns:f.map((function(e){return e.id}))});case 36:return e.next=38,ne("INSERT INTO colorpk_user (oauth, name, oauth_id, last_login) VALUES (?, ?, ?, NOW())",[n,a,c]);case 38:return m=e.sent,g=m.insertId,t.session.app.dbInfo={id:g,name:a,isAdmin:!1},e.abrupt("return",{name:a,isAdmin:!1,img:j()(o,"picture.data.url",null),likes:[],owns:[]});case 44:return e.prev=44,e.t0=e.catch(3),e.abrupt("return",new z.GraphQLError(e.t0.toString()));case 47:e.next=50;break;case 49:return e.abrupt("return",null);case 50:case"end":return e.stop()}var v}),e,null,[[3,44]])})))()},color:function(e,t){return se(ae().mark((function r(){var n,o;return ae().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.category,P(t)||"ANONYMOUS"!==n){r.next=3;break}return r.abrupt("return",new z.GraphQLError("color error: no admin access"));case 3:o=null,r.t0=n,r.next="PUBLIC"===r.t0?7:"ANONYMOUS"===r.t0?11:15;break;case 7:return r.next=9,ne("SELECT a.* FROM colorpk_color a WHERE a.display=0 ORDER BY `id` DESC");case 9:case 13:return o=r.sent,r.abrupt("break",16);case 11:return r.next=13,ne("SELECT * FROM colorpk_color a WHERE a.display = 1");case 15:return r.abrupt("break",16);case 16:return r.prev=16,r.abrupt("return",o.map((function(e){return{id:e.id,star:e.star,color:e.color,userId:e.user_id,username:e.username,createdDate:e.created_date}})));case 20:return r.prev=20,r.t1=r.catch(16),r.abrupt("return",new z.GraphQLError(r.t1.toString()));case 23:case"end":return r.stop()}}),r,null,[[16,20]])})))()},likeColor:function(e,t){return se(ae().mark((function r(){var n,o,i,a,c;return ae().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.input,o=n.id,i=n.willLike,r.prev=2,A(t)&&(a=j()(t,"session.app.dbInfo.id",null),ne(i?"INSERT INTO colorpk_userlike (user_id, color_id) VALUES (?, ?)":"DELETE FROM colorpk_userlike WHERE user_id= ? AND color_id = ?",[a,o])),!i){r.next=9;break}return r.next=7,ne("UPDATE colorpk_color SET `star` = `star` + 1 WHERE id = ?",[o]);case 7:return c=r.sent,r.abrupt("return",{status:1===c.affectedRows?0:1});case 9:return r.abrupt("return",{status:0});case 12:return r.prev=12,r.t0=r.catch(2),r.abrupt("return",new z.GraphQLError(r.t0.toString()));case 15:case"end":return r.stop()}}),r,null,[[2,12]])})))()},createColor:function(e,t){return se(ae().mark((function r(){var n,o,i,a,c,s,u,l,d;return ae().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.input,o=n.color,oe("#".concat(o))){r.next=4;break}return r.abrupt("return",new z.GraphQLError("create error: invalid color input"));case 4:return i=j()(t,"session.app.dbInfo.name",null),a=j()(t,"session.app.dbInfo.id",null),c=A(t)&&i,s=c?i:null,u=c?a:null,l=(20*Math.random()).toFixed(),r.prev=10,r.next=13,ne("INSERT INTO colorpk_color (`star`, color, user_id, username, color_type, display, created_date) VALUES (?, ?, ?, ?, NULL, ?, NOW())",[l,o,u,s,c?0:1]);case 13:return d=r.sent,r.abrupt("return",{status:0,data:d.insertId});case 17:return r.prev=17,r.t0=r.catch(10),r.abrupt("return",new z.GraphQLError(r.t0.toString()));case 20:case"end":return r.stop()}}),r,null,[[10,17]])})))()},adjudicateColor:function(e,t){return se(ae().mark((function r(){var n,o,i,a;return ae().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=e.input,P(t)){r.next=3;break}return r.abrupt("return",new z.GraphQLError("adjudicate error: no admin access"));case 3:return o=n.id,i=n.willLike,r.prev=4,r.next=7,ne(i?"UPDATE colorpk_color SET `display` = 0 WHERE id = ?":"DELETE FROM colorpk_color WHERE id = ?",[o]);case 7:return a=r.sent,r.abrupt("return",{status:1===a.affectedRows?0:1});case 11:return r.prev=11,r.t0=r.catch(4),r.abrupt("return",new z.GraphQLError(r.t0.toString()));case 14:case"end":return r.stop()}}),r,null,[[4,11]])})))()}};const le=(0,z.buildSchema)("\n  enum ColorCategory {\n    PUBLIC\n    ANONYMOUS\n  }\n\n  interface MutationResponse {\n    status: Int!\n  }\n\n  type Color {\n    id: ID!\n    star: Int!\n    color: String!\n    userId: ID\n    username: String\n    createdDate: String\n  }\n\n  type User {\n    img: String\n    isAdmin: Boolean\n    name: String\n    likes: [ID!]\n    owns: [ID!]\n  }\n\n  input LikeColorInputType {\n    id: ID!\n    willLike: Boolean!\n  }\n  \n  input CreateColorInputType {\n    color: String!\n  }\n\n  type LikeColorOutputType implements MutationResponse {\n    status: Int!\n  }\n\n  type AdjudicateColorOutputType implements MutationResponse {\n    status: Int!\n  }\n\n  type CreateColorOutputType implements MutationResponse {\n    status: Int!\n    data: ID!\n  }\n\n  type Mutation {\n    likeColor(input: LikeColorInputType!): LikeColorOutputType\n    createColor(input: CreateColorInputType!): CreateColorOutputType\n    adjudicateColor(input: LikeColorInputType!): AdjudicateColorOutputType\n  }\n  \n  type Query {\n    color(category: ColorCategory!): [Color]\n    user: User\n  }\n\n  schema {\n    query: Query\n    mutation: Mutation\n  } \n"),de=(0,Y.graphqlHTTP)({schema:le,rootValue:ue,graphiql:!1,pretty:!1}),pe=require("react-redux"),fe=require("react-router-dom/server"),he=require("redux"),me=require("react-dom/server");var ge=r(991);const ve=require("prop-types");var ye=r.n(ve);const be=require("react"),we=require("react/jsx-runtime");var xe="ColorPK v1",ke="colorpk",je="Your Best Color Picker | 全球最大色彩搭配网站 | 颜色搭配 | 艺术设计",_e="https://repository-images.githubusercontent.com/75897824/b1278e80-8704-11ea-9acf-ac166e4ad4fd";const Ee=function(){return(0,we.jsxs)(be.Fragment,{children:[(0,we.jsx)("meta",{property:"og:title",content:xe}),(0,we.jsx)("meta",{property:"og:type",content:"website"}),(0,we.jsx)("meta",{property:"og:url",content:"https://react.colorpk.com"}),(0,we.jsx)("meta",{property:"og:description",content:je}),(0,we.jsx)("meta",{property:"og:site_name",content:ke}),(0,we.jsx)("meta",{property:"og:image",content:_e}),(0,we.jsx)("meta",{property:"og:image:secure_url",content:_e}),(0,we.jsx)("meta",{property:"og:image:type",content:"image/png"}),(0,we.jsx)("meta",{property:"og:image:width",content:1280}),(0,we.jsx)("meta",{property:"og:image:height",content:640}),(0,we.jsx)("meta",{property:"og:image:alt",content:ke}),(0,we.jsx)("meta",{name:"twitter:card",content:"summary_large_image"}),(0,we.jsx)("meta",{name:"twitter:site",content:ke}),(0,we.jsx)("meta",{name:"twitter:title",content:xe}),(0,we.jsx)("meta",{name:"twitter:description",content:je}),(0,we.jsx)("meta",{name:"twitter:image",content:_e}),(0,we.jsx)("meta",{name:"twitter:image:width",content:1280}),(0,we.jsx)("meta",{name:"twitter:image:height",content:640}),(0,we.jsx)("meta",{name:"twitter:image:alt",content:ke})]})},Le=require("serialize-javascript");var Se=r.n(Le),Ce=function(e){var t=e.title,r=e.style,n=e.script,o=e.children,i=e.csrfToken,a=e.isVertical,c=e.languageCode,s=e.lastBuildDate,u=e.initState;return(0,we.jsxs)("html",{lang:"en",children:[(0,we.jsxs)("head",{children:[(0,we.jsx)("meta",{charSet:"utf-8"}),(0,we.jsx)("meta",{httpEquiv:"X-UA-Compatible",content:"IE=edge"}),(0,we.jsx)(Ee,{}),(0,we.jsx)("title",{children:t}),(0,we.jsx)("meta",{name:"description",content:"ColorPK | Faster lighter and nicer than colorhunt | 全球最大色彩搭配网站 | 颜色搭配 | 艺术设计"}),(0,we.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"}),(0,we.jsx)("meta",{name:"robots",content:"INDEX,FOLLOW"}),(0,we.jsx)("meta",{name:"keywords",content:"colorpk, colorpicker, color picker, palette, color combination"}),(0,we.jsx)("link",{rel:"shortcut icon",href:"//dkny.oss-cn-hangzhou.aliyuncs.com/3/fav.ico"}),(0,we.jsx)("link",{href:r,rel:"stylesheet"}),(0,we.jsx)("script",{dangerouslySetInnerHTML:{__html:"if(window.location.hostname.indexOf('colorpk.com') > -1){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-5LX6LV3');} var initLoadTime = Date.now();window.addEventListener('_COLORPK_SCRIPT_READY', function(){window.dataLayer.push({'scriptLoadingTime': Date.now() - initLoadTime});console.log('server last build: ".concat(s,"');});\n          ")}})]}),(0,we.jsxs)("body",{children:[(0,we.jsx)("noscript",{children:(0,we.jsx)("iframe",{src:"https://www.googletagmanager.com/ns.html?id=GTM-5LX6LV3",height:"0",width:"0",style:{display:"none",visibility:"hidden"}})}),(0,we.jsx)("div",{id:"app",dangerouslySetInnerHTML:{__html:o}}),(0,we.jsx)("div",{id:ge.yY}),(0,we.jsx)("div",{id:"csrf","data-token":i}),(0,we.jsx)("script",{dangerouslySetInnerHTML:{__html:"window.".concat(ge.kl,"=").concat(Se()(u),"; window.").concat(ge.CT,'="').concat(c,'"; window.').concat(ge.jl,"=").concat(a,"; ")}}),(0,we.jsx)("script",{src:n,type:"text/javascript"})]})]})};Ce.propTypes={title:ye().string.isRequired,isVertical:ye().bool.isRequired,languageCode:ye().string.isRequired,lastBuildDate:ye().string.isRequired,style:ye().string.isRequired,script:ye().string.isRequired,children:ye().string.isRequired,csrfToken:ye().string.isRequired,initState:ye().object.isRequired};const Oe=Ce,Te="uCFqZ";var Ie=r(984);const Ne=require("react-router-dom"),Ae="EQXN2",Re="nzlHR",Pe="MaSpR",qe="iYPlb",De="m_HVm";const Me=function(){return(0,we.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",children:[(0,we.jsx)("title",{children:"translation"}),(0,we.jsx)("path",{d:"M0 0h24v24H0z",fill:"none"}),(0,we.jsx)("path",{d:" M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z "})]})};var Ue=function(e){var t=e.languages,r=e.onChange;return(0,we.jsx)("div",{className:"navbar-dropdown",children:t.map((function(e){return(0,we.jsx)("a",{className:"navbar-item",onClick:function(){r(e.code)},children:e.name},e.code)}))})};Ue.propTypes={onChange:ye().func.isRequired,languages:ye().array.isRequired};const Be=Ue;var Fe=function(e){var t=e.onClick;return(0,we.jsxs)("a",{role:"nav toggle btn",className:"navbar-burger burger","aria-label":"nav menu","aria-expanded":"false",onClick:t,children:[(0,we.jsx)("span",{"aria-hidden":"true"}),(0,we.jsx)("span",{"aria-hidden":"true"}),(0,we.jsx)("span",{"aria-hidden":"true"})]})};Fe.propTypes={onClick:ye().func.isRequired};const Ge=Fe;const He=function(){return(0,be.useContext)(gt)};var Qe=[],We={},Ye={};function ze(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,c=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ve(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Ve(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}[{code:"en",name:"English",data:{language:"Language",popular:"Popular",latest:"Latest",more:"More",about:"About",newColor:"New Color",navLogin:"Login",reportIssue:"Report an issue",download:"Download",submit:"Submit",reset:"Reset",return:"Return",profile:"Profile",like:"Like",admin:"Admin",logOut:"Log Out",facebook:"FaceBook",twitter:"Twitter",email:"E-Mail",noColorsToShow:"No colors to display",undefinedColorId:"Color ID is not defined"}},{code:"zh",name:"简体中文",data:{language:"多语言",popular:"最热",latest:"最新",more:"更多",about:"关于",newColor:"创建新颜色",navLogin:"登录",reportIssue:"报告错误",download:"下载",submit:"添加",reset:"重置",return:"返回",profile:"我的颜色",like:"我的收藏",admin:"管理员",logOut:"注销",facebook:"脸书",twitter:"推特",email:"电邮",noColorsToShow:"没有可以显示的颜色",undefinedColorId:"颜色ID未定义"}},{code:"ja",name:"日本語",data:{language:"言語",popular:"人気のある",latest:"最新",more:"もっと",about:"約",newColor:"色をつくる",navLogin:"ログイン",reportIssue:"問題を報告する",download:"ダウンロード",submit:"提出する",reset:"リセット",return:"戻る",profile:"プロフィール",like:"好む",admin:"管理者",logOut:"サインアウト",facebook:"FaceBook",twitter:"さえずり",email:"Eメール",noColorsToShow:"表示する色がありません",undefinedColorId:"IDが定義されていません"}},{code:"ko",name:"한국어",data:{language:"언어",popular:"인기 있는",latest:"최근",more:"더",about:"약",newColor:"몹시 떠들어 대다",navLogin:"로그인",reportIssue:"보고 문제",download:"다운로드",submit:"제출하다",reset:"다시 놓기",return:"반환",profile:"윤곽",like:"인기 있는 말",admin:"관리자",logOut:"로그 아웃하다",facebook:"페이스 북",twitter:"지저귀다",email:"이메일",noColorsToShow:"표시 할 색상이 없습니다",undefinedColorId:"ID가 정의되지 않았습니다"}},{code:"es",name:"Español",data:{language:"idioma",popular:"popular",latest:"más reciente",more:"Más",about:"acerca de",newColor:"crear nuevo",navLogin:"Iniciar sesión",reportIssue:"informe de problema",download:"descargar",submit:"enviar",reset:"Reiniciar",return:"regreso",profile:"perfil",like:"favorita",admin:"administración",logOut:"cerrar sesión",facebook:"Facebook",twitter:"gorjeo",email:"correo electrónico",noColorsToShow:"No hay color para mostrar",undefinedColorId:"ID no está definido"}}].forEach((function(e){Qe.push({code:e.code,name:e.name}),We[e.code]=e.data,Ye[e.code]=!0}));var Xe=(0,be.createContext)(),Ke=function(e){var t=e.children,r=e.initLang,n=e.onChange,o=ze((0,be.useState)(r),2),i=o[0],a=o[1];return(0,be.useEffect)((function(){n(i)}),[i]),(0,we.jsx)(Xe.Provider,{value:[We[i],a],children:t})};Ke.propTypes={children:ye().element.isRequired,initLang:ye().string,onChange:ye().func};const Ze=function(){return(0,be.useContext)(Xe)};function $e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,c=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Je(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Je(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Je(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var et=Ae,tt=function(e){var t=e.detail,r=e.likeNum,n=e.weiboUrl,o=e.githubUrl,i=e.facebookUrl,a=e.languages,c=e.onLogout,s=(0,Ne.useLocation)().pathname,u=$e((0,be.useState)(!1),2),l=u[0],d=u[1],p=$e(He(),2),f=p[0],h=p[1],m=$e(Ze(),2),g=m[0],v=m[1],y=Boolean(t),b=y&&t.isAdmin,w=y&&t.img,x=w||"".concat(ge.Qi,"/icon.png"),k="/popular"===s,j=["/","/latest"].includes(s),_=["/like","/portfolio"].includes(s),E="/like"===s,L="/new"===s,S=function(){d(!1)},C=function(){d(!1),window.scrollTo(0,0)};return(0,we.jsxs)("nav",{className:"navbar is-fixed-top",role:"navigation","aria-label":"main navigation",children:[(0,we.jsxs)("div",{className:"navbar-brand",children:[(0,we.jsx)("div",{title:"click to rotate","aria-label":"click to rotate",className:"navbar-item ".concat(qe),onClick:function(){d(!1),h(!f)},children:(0,we.jsx)("img",{src:x,className:"".concat(w||f?"":Pe),alt:"icon"})}),(0,we.jsx)(Ge,{onClick:function(){return d((function(e){return!e}))}})]}),(0,we.jsxs)("div",{className:"navbar-menu ".concat(l?"is-active":""),children:[(0,we.jsxs)("div",{className:"navbar-start",children:[y?(0,we.jsxs)("div",{className:"navbar-item has-dropdown is-hoverable",children:[(0,we.jsx)("a",{className:"navbar-link ".concat(_?et:""),children:t.name}),(0,we.jsxs)("div",{className:"navbar-dropdown",children:[(0,we.jsx)(Ne.Link,{className:"navbar-item",to:"/portfolio",onClick:C,children:g.profile}),(0,we.jsx)(Ne.Link,{to:"/like",className:"navbar-item",onClick:C,children:g.like}),b&&(0,we.jsx)(Ne.Link,{to:"/adminpanel",className:"navbar-item",onClick:C,children:g.admin})]})]}):(0,we.jsxs)(Ne.Link,{to:"/like",className:"navbar-item ".concat(E?et:""),onClick:C,children:[g.like,r>0&&" (".concat(r,")")]}),(0,we.jsx)(Ne.Link,{to:"/popular",className:"navbar-item ".concat(k?et:""),onClick:S,children:g.popular}),(0,we.jsx)(Ne.Link,{to:"/latest",className:"navbar-item ".concat(j?et:""),onClick:S,children:g.latest}),(0,we.jsxs)("div",{className:"navbar-item has-dropdown is-hoverable ".concat(De),children:[(0,we.jsx)("a",{className:"navbar-link",children:g.more}),(0,we.jsxs)("div",{className:"navbar-dropdown",children:[(0,we.jsx)("a",{className:"navbar-item",href:"//www.colorpk.com",children:"ColorPK v2.0"}),(0,we.jsx)("a",{className:"navbar-item",href:"//www.colorpk.com/about",children:g.about}),(0,we.jsx)("hr",{className:"navbar-divider"}),(0,we.jsx)("a",{className:"navbar-item",href:"//github.com/im6/vp/issues",children:g.reportIssue})]})]}),(0,we.jsxs)("div",{className:"navbar-item has-dropdown is-hoverable",children:[(0,we.jsxs)("a",{className:"navbar-link",children:[(0,we.jsx)(Me,{}),(0,we.jsx)("span",{className:Re,children:g.language})]}),(0,we.jsx)(Be,{languages:a,onChange:v})]})]}),(0,we.jsxs)("div",{className:"navbar-end",children:[!y&&(0,we.jsxs)("div",{className:"navbar-item has-dropdown is-hoverable",children:[(0,we.jsx)("a",{className:"navbar-link",children:g.navLogin}),(0,we.jsxs)("div",{className:"navbar-dropdown",children:[(0,we.jsx)("a",{className:"navbar-item",href:n,children:"微博"}),(0,we.jsx)("a",{className:"navbar-item",href:o,children:"GitHub"}),i&&(0,we.jsx)("a",{className:"navbar-item",href:i,children:"FaceBook"})]})]}),(0,we.jsx)("div",{className:"navbar-item",children:(0,we.jsxs)("div",{className:"buttons",children:[y&&(0,we.jsx)(Ne.Link,{className:"button is-danger",to:"/",onClick:function(){c(),S()},children:g.logOut}),!L&&(0,we.jsx)(Ne.Link,{to:"/new",className:"button is-primary",onClick:C,children:g.newColor})]})})]})]})]})};tt.propTypes={detail:ye().object,weiboUrl:ye().string,githubUrl:ye().string,facebookUrl:ye().string,likeNum:ye().number,languages:ye().array.isRequired,onLogout:ye().func.isRequired};const rt=tt;const nt=(0,pe.connect)((function(e){var t=e.user,r=e.color,n=t.detail,o=t.weiboUrl,i=t.githubUrl,a=t.facebookUrl;return{detail:n,likeNum:r.liked.length,languages:Qe,weiboUrl:o,githubUrl:i,facebookUrl:a}}),(function(e){return{onLogout:function(){var t=(0,Ie.createAction)("user/logoff");e(t());var r=(0,Ie.createAction)("modal/user/logoff");e(r())}}}))(rt);var ot=function(){return(0,we.jsx)("div",{className:"spinContainer",children:(0,we.jsx)("div",{className:"spinLoader"})})};const it=(0,be.memo)(ot);function at(e){return at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},at(e)}function ct(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function st(e,t){return st=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},st(e,t)}function ut(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=dt(e);if(t){var o=dt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return lt(this,r)}}function lt(e,t){if(t&&("object"===at(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function dt(e){return dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},dt(e)}var pt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&st(e,t)}(i,e);var t,r,n,o=ut(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).state={loading:!0},t}return t=i,(r=[{key:"componentDidMount",value:function(){this.setState({loading:!1})}},{key:"render",value:function(){var e=this.state.loading,t=this.props.children;return(0,we.jsxs)("div",{className:Te,children:[(0,we.jsx)(nt,{}),e?(0,we.jsx)(it,{}):t]})}}])&&ct(t.prototype,r),n&&ct(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(be.Component);pt.propTypes={children:ye().node};const ft=pt;function ht(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==r)return;var n,o,i=[],a=!0,c=!1;try{for(r=r.call(e);!(a=(n=r.next()).done)&&(i.push(n.value),!t||i.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(c)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return mt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return mt(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function mt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var gt=(0,be.createContext)(),vt=function(e){var t=e.children,r=e.initVertical,n=e.onChange,o=ht((0,be.useState)(r),2),i=o[0],a=o[1];return(0,be.useEffect)((function(){n(i)}),[i]),(0,we.jsx)(gt.Provider,{value:[i,a],children:(0,we.jsx)(ft,{children:t})})};vt.propTypes={children:ye().node,initVertical:ye().bool,onChange:ye().func};var yt=r(287);const bt=yt.keys().reduce((function(e,t){return e[t.replace(/\.js$/,"").replace(/^.\//,"")]=yt(t).default,e}),{}),wt=function(e,t){var r,n=A(e,!0),o=e.cookies[ge.CT],i=e.cookies[ge.jl],a=o&&Ye[o]?o:ge.$q,c=["0","1"].includes(i)?"1"===i:ge.ZA;if(n)r={loading:!0,detail:{name:"loading",isAdmin:P(e)}};else{var s=(0,_.v1)();e.session.app={oauthState:s},r={loading:!0,detail:null,weiboUrl:S("wb",s),githubUrl:S("gh",s),facebookUrl:null}}var u=(0,he.createStore)((0,he.combineReducers)(bt),{user:r,color:{loading:!0,colorDef:{},liked:{},colorIdAllByDate:[],colorIdAllByStar:[],colorIdByMyOwn:[]}}),l=(0,we.jsx)(fe.StaticRouter,{location:e.url,children:(0,we.jsx)(pe.Provider,{store:u,children:(0,we.jsx)(Ke,{initLang:a,children:(0,we.jsx)(vt,{initVertical:c})})})}),d=(0,we.jsx)(Oe,{title:"".concat("ColorPK | Your Best Color Picker"),languageCode:a,isVertical:c,style:"".concat(h._7,"/main.css"),script:"".concat(h._7,"/main.js"),csrfToken:e.csrfToken(),lastBuildDate:"10/10/2022, 12:09:27 AM EST",initState:u.getState(),children:(0,me.renderToString)(l)}),p=(0,me.renderToStaticMarkup)(d);t.status(200),t.send("<!DOCTYPE html>".concat(p))};var xt=i()();xt.set("trust proxy",!0),xt.use(n()({contentSecurityPolicy:!1,crossOriginEmbedderPolicy:!1})),xt.use((0,a.json)()),xt.use((0,a.urlencoded)({extended:!1})),xt.use(s()()),xt.use(x);var kt=r(619).Z;h.TM.forEach((function(e){xt.get(e,kt)})),xt.get("/_ah/:action",(function(e,t){var r=e.params.action;t.json({status:"".concat(r," - ok")})})),xt.use(W),xt.post("/graphql",de),xt.get("/auth/logout",(function(e,t){var r=j()(e,"session.app.dbInfo.name","unknown");console.log("logoff (".concat(r,"), delete session")),delete e.session.app;var n=(0,_.v1)();e.session.app={oauthState:n},t.json({weiboUrl:S("wb",n),githubUrl:S("gh",n),facebookUrl:S("fb",n)})})),xt.get("/auth/:oauth",U),["/","/latest","/popular","/color/:id","/new","/like"].forEach((function(e){xt.get(e,wt)})),xt.get("/portfolio",(function(e,t,r){A(e)?r():r(401)}),wt),xt.get("/adminpanel",(function(e,t,r){P(e)?r():r(403)}),wt),xt.use((function(e,t){console.error("Error: 404, ".concat(e.url," not found")),t.status(400).sendFile(F)})),xt.use((function(e,t,r,n){console.error("Error: ".concat(e.toString(),", ").concat(t.url)),"POST"===t.method?r.status(400).json({errors:!0}):r.status(400).sendFile(F)}));xt.listen(h.px,(function(){return console.log("app (mode: ".concat("production",") is running on: http://localhost:").concat(h.px))})).timeout=5e3,(0,e.exec)("curl ifconfig.me",(function(e,t,r){e?console.error(r):console.log("public IP addr: ".concat(t))}))})()})();